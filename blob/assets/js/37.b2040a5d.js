(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{495:function(s,t,a){"use strict";a.r(t);var n=a(31),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ä¸€ä¸ªç®€å•çš„åˆçº§ç™»å½•ç³»ç»Ÿ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ä¸ªç®€å•çš„åˆçº§ç™»å½•ç³»ç»Ÿ"}},[s._v("#")]),s._v(" ä¸€ä¸ªç®€å•çš„åˆçº§ç™»å½•ç³»ç»Ÿ")]),s._v(" "),a("p",[s._v("å…ˆå‰ä¸€ç›´åœ¨æƒ³ç™»å½•ç³»ç»Ÿåˆ°åº•è¯¥æ€æ ·ç®€æ´åœ°å®ç°ã€‚åœ¨è¿™é‡Œï¼Œ"),a("em",[s._v("ç®€æ´")]),s._v("æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³æœ€åŸºæœ¬çš„ç”¨æˆ·è¯†åˆ«éœ€æ±‚ï¼Œè€Œæ²¡æœ‰å…¶å®ƒæ›´å¤šæ–¹é¢çš„éœ€æ±‚ï¼Œä¾‹å¦‚éªŒè¯æ–¹é¢ã€å®‰å…¨æ–¹é¢ç­‰ç­‰ã€‚å› è€Œæ¦‚æ‹¬æ¥è¯´ï¼Œæˆ‘ä»¬æ‰€è¦å®ç°çš„åªæ˜¯\nç™»å½•ä»¥åå‚¨å­˜çŠ¶æ€ï¼Œæ ¹æ®è¯¥çŠ¶æ€åˆ¤å®šè®¿é—®æƒé™ã€‚")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("ğŸ˜ æœ¬æ–‡ä»£ç ä½¿ç”¨ PHP å®ç°ã€‚")])]),s._v(" "),a("h2",{attrs:{id:"åŸºæœ¬æ€è·¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬æ€è·¯"}},[s._v("#")]),s._v(" åŸºæœ¬æ€è·¯")]),s._v(" "),a("p",[s._v("è¿™æ ·ä¸€ä¸ªç®€å•çš„ç™»å½•ç³»ç»Ÿçš„æ€è·¯ï¼Œå¤§è‡´å¦‚ä¸‹")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("å‰ç«¯æ”¶é›†ç™»å½•ä¿¡æ¯ã€‚")]),s._v(" åŒ…å«æœ€åŸºæœ¬çš„ä¸¤é¡¹ï¼šç”¨æˆ·åå’Œå¯†ç ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("åç«¯éªŒè¯ä¿¡æ¯å¹¶å‘æ”¾ "),a("em",[s._v("Token")]),s._v("ã€‚")]),s._v(" åœ¨è¿™é‡Œï¼ŒéªŒè¯ä¿¡æ¯ä¸»è¦æ˜¯å¯¹æ•°æ®åº“ä¸­å¯¹åº”ç”¨æˆ·åçš„å¯†ç è¿›è¡Œæ¯”å¯¹ï¼Œå¯èƒ½çš„ç»“æœæœ‰"),a("em",[s._v("ä¸å­˜åœ¨")]),s._v("ã€"),a("em",[s._v("ä¸åŒ¹é…")]),s._v("å’Œ"),a("em",[s._v("åŒ¹é…")]),s._v("ä¸‰ç§ã€‚æœ¬æ–‡ä¸­æ¯”å¯¹æ‰€ä½¿ç”¨çš„æ–¹å¼æ˜¯ "),a("code",[s._v("password_verify")]),s._v(" å‡½æ•°ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("å‰ç«¯å­˜å‚¨ "),a("em",[s._v("Token")]),s._v(" å¹¶ç”¨äºæ‰§è¡Œå„é¡¹æ“ä½œã€‚")]),s._v(" åç«¯æ‰€éœ€è¦æƒé™çš„æ“ä½œå¯ä»¥å°† Token ä½œä¸ºå‚æ•°ï¼Œéœ€è¦ Token æ‰èƒ½å·¥ä½œã€‚å‰ç«¯å­˜å‚¨ Token çš„åŠæ³•ï¼Œå¯ä»¥ç”¨ "),a("code",[s._v("localStorage")]),s._v("ã€‚å½“ç„¶ï¼Œä½¿ç”¨ Cookie ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚æœ¬æ–‡æ¼”ç¤ºå‰è€…ï¼Œå®ç°æ–¹å¼ç±»ä¼¼ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("é’ˆå¯¹ä¸åŒçŠ¶å†µæ‹Ÿå®š "),a("em",[s._v("Token")]),s._v(" renew & expire ç­–ç•¥ã€‚")]),s._v(" Token ä¸€å®šè¦æœ‰æœ‰æ•ˆæœŸï¼Œè‡ªç„¶è€Œç„¶ä¹Ÿæœ‰ renew å’Œ expire ç­‰é—®é¢˜ã€‚")])]),s._v(" "),a("p",[s._v("ä¸Šé¢å››æ¡ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥æ³¨æ„è§£é‡Šå’Œå®è·µã€‚")]),s._v(" "),a("h2",{attrs:{id:"å®è·µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®è·µ"}},[s._v("#")]),s._v(" å®è·µ")]),s._v(" "),a("h3",{attrs:{id:"_1-token-è®¾è®¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-token-è®¾è®¡"}},[s._v("#")]),s._v(" 1. Token è®¾è®¡")]),s._v(" "),a("p",[s._v("Token åˆ°åº•åº”è¯¥é•¿ä»€ä¹ˆæ ·ï¼Ÿå®é™…ä¸Šåº”è¯¥å…ˆè®¨è®ºæˆ‘ä»¬è¯¥æ€æ ·ä¼ é€’ Tokenã€‚ä¸ºäº†å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å¿…å®šè¦è®¾è®¡ä¸€äº›åŠ å¯†ï¼ˆencryptï¼‰æ–¹æ³•ã€‚ä¸ºäº†ä¿¡æ¯å¯å¤„ç†ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ€è€ƒæ€æ ·è¿›è¡Œè§£å¯†ï¼ˆdecryptï¼‰ã€‚åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å½“ç„¶ä¸èƒ½ç”¨ç®€ç®€å•å•çš„ base64 æ··åˆå…¶å®ƒèŠ±é‡Œèƒ¡å“¨æ–¹æ³•çš„è‚¤æµ…åŠ å¯†ï¼Œè€Œè¦ä½¿ç”¨ OpenSSL çš„ç›¸å…³æ–¹æ³•ã€‚")]),s._v(" "),a("p",[s._v("é¦–å…ˆï¼ŒOpenSSL çš„åŠ å¯†å‡½æ•°ä¸º "),a("code",[s._v("openssl_encrypt")]),s._v("ï¼Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥å°è£…å‡ºä¸€ä¸ªç®€å•çš„å®é™… encryptã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("encrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonceSize")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_cipher_iv_length")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'aes-256-ctr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_random_pseudo_bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonceSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_encrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'aes-256-ctr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OPENSSL_RAW_DATA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("å…¶ä¸­ï¼Œ"),a("strong",[s._v("aes-256-ctr")]),s._v(" ä¸ºåŠ å¯†æ–¹å¼ï¼Œå…·ä½“å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢äº†è§£ï¼Œè¿™æ˜¯æ¯”è¾ƒæ¨èä½¿ç”¨çš„ä¸€ç§æ–¹å¼ã€‚ä¸Šé¢çš„å‡½æ•°å…·ä½“å†…å®¹å°±ä¸å¤šè§£é‡Šã€‚åˆ©ç”¨ä¸Šé¢çš„å‡½æ•°ï¼Œåªéœ€è¦ä¸€ä¸ª key å³å¯å¯¹æŒ‡å®šä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œè¿™äº›ä¿¡æ¯ä¾¿æ˜¯æˆ‘ä»¬çš„ Tokenã€‚")]),s._v(" "),a("p",[s._v("é’ˆå¯¹ä¸Šé¢çš„ encrypt å‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€ä¸ªå¯¹åº”çš„ decrypt å‡½æ•°ã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonceSize")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_cipher_iv_length")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'aes-256-ctr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mb_substr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonceSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'8bit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mb_substr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonceSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'8bit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$plaintext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'aes-256-ctr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OPENSSL_RAW_DATA")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$plaintext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("è€Œå®é™…ä¸Šï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½å¹¶ä¸å®Œå…¨å®‰å…¨ã€‚åœ¨åæ–‡ï¼Œæˆ‘ä»¬ä¼šä»‹ç»æ›´ä¸ºå®‰å…¨çš„ç‰ˆæœ¬ã€‚")]),s._v(" "),a("p",[s._v("è¿™ä¸¤å‡½æ•°ä¾¿è´Ÿè´£äº†åŠ å¯†å’Œè§£å¯†ã€‚æ¥ä¸‹æ¥ Token å†…å®¹çš„ç»„ç»‡ä¾¿å¾ˆå®¹æ˜“äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€ç®€å•çš„ï¼Œé‚£å°±æ˜¯ JSONã€‚ä¾‹å¦‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$token")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("json_encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"expires"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strtotime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"+1 week"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"creates"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("å¯¹è¿™ä¸ª Tokenï¼Œæˆ‘ä»¬è¿›è¡Œ encryptï¼Œç„¶åè¿”å›åˆ°å‰ç«¯ï¼ŒåŸºæœ¬ä¸Šå°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ã€‚è¿™ä¸ª Token åœ¨å‰ç«¯å°†é•¿ä¹…å­˜åœ¨ï¼Œå› è€Œå…¶å¿…é¡»æŒ‡å®šä¸€ä¸ªåˆç†çš„ expires ä»¥ä¾¿åç«¯åˆ¤æ–­å…¶æœ‰æ•ˆæ€§ã€‚åŒæ—¶ä¸ºäº†é¿å…å†’å……ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ Token å†…åŠ å…¥ä¸€äº›ç‰¹å¼‚æ€§å†…å®¹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ç­¾åã€‚")]),s._v(" "),a("h3",{attrs:{id:"token-å­˜å‚¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-å­˜å‚¨"}},[s._v("#")]),s._v(" Token å­˜å‚¨")]),s._v(" "),a("p",[s._v("æŒ‰ç…§è®¾è®¡ï¼ŒToken è¢«è¿”å›åˆ°å‰ç«¯ä»¥åä¼šè¢«å­˜å‚¨èµ·æ¥ï¼Œç›®çš„æ˜¯ä½œä¸ºæ•æ„Ÿæ“ä½œï¼ˆæ¶‰åŠæƒé™çš„æ“ä½œï¼‰çš„å‡­è¯ã€‚ä¾‹å¦‚è‹¥è¦ POST æ¶‰åŠæƒé™çš„æ“ä½œï¼Œåˆ™å¿…é¡»å¸¦ä¸Š Tokenï¼Œå¦åˆ™è¿”å› 400ã€‚")]),s._v(" "),a("p",[s._v("ä¸Šæ–‡å·²ç»æåˆ°ï¼Œæˆ‘ä»¬å°†ä¼šä½¿ç”¨ localStorage æˆ–è€… Cookieã€‚ä¾‹å¦‚")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‡è®¾ r ä¸ºåç«¯è¿”å›çš„ Tokenï¼ˆå·²åŠ å¯†å­—ç¬¦ä¸²ï¼‰")]),s._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx-login-token'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("è‡³æ­¤å®ƒå°±è¢«å­˜äº†èµ·æ¥ã€‚è‡³äº localStorage ä¿å­˜æ•°æ®çš„æŒç»­æ€§ï¼Œå¯ä»¥å‚è€ƒ StackOverflow "),a("a",{attrs:{href:"https://stackoverflow.com/questions/9948284/how-persistent-is-localstorage",target:"_blank",rel:"noopener noreferrer"}},[s._v("How Persistent is localStorage?"),a("OutboundLink")],1),s._v("ã€‚")]),s._v(" "),a("p",[s._v("å¯¹äº Chromeï¼ŒlocalStorage æŒç»­æ€§çš„å™è¿°ä¸º")]),s._v(" "),a("blockquote",[a("p",[s._v("On disk until deleted by user (delete cache) or by the app.")])]),s._v(" "),a("p",[a("small",[s._v("æ¥è‡ª "),a("a",{attrs:{href:"http://www.gwtproject.org/doc/latest/DevGuideHtml5Storage.html",target:"_blank"}},[s._v("GWTProject")])])]),s._v(" "),a("p",[s._v("æ‰€ä»¥å®é™…ä¸Šä¸éœ€è¦æ‹…å¿ƒ localStorage è¢«æ— ç¼˜æ— æ•…æ¸…æ‰ã€‚æ¢å¥è¯è¯´ï¼ŒToken å°†ä¼šåœ¨ localStorage ä¸­é•¿æœŸå­˜åœ¨ã€‚")]),s._v(" "),a("p",[s._v("åœ¨è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šlocalStorage åœ¨å®šä¹‰ä¸Šæ˜¯å±äºç”¨æˆ·çš„ä¸œè¥¿ï¼Œç”¨æˆ·å¯ä»¥å®Œå…¨ç®¡ç†å…¶å†…å®¹ï¼Œå¯ä»¥æ·»åŠ ã€è¯»å–å’Œä¿®æ”¹å…¶å†…å®¹ï¼Œè¿™ä¼šå¯¹ Token çš„å®‰å…¨æ€§é€ æˆä»€ä¹ˆå½±å“ï¼Ÿ")]),s._v(" "),a("p",[s._v("å®é™…ä¸ŠåŸºæœ¬æ²¡æœ‰ã€‚å› ä¸º Token åªèƒ½ç”±åç«¯ç”Ÿæˆï¼Œè€Œç”¨æˆ·æŠŠ Token ä¿®æ”¹äº†ç›¸å½“äºè‡ªå·±æ”¾å¼ƒäº†è¿™ä¸ª Tokenï¼Œè¢«ä¿®æ”¹åçš„ Token ä¹Ÿæ— æ³•é€šè¿‡éªŒè¯ï¼ˆdecryptï¼‰ã€‚å”¯ä¸€éœ€è¦é˜²å¤‡çš„ï¼Œå°±æ˜¯ä¸è¦æ³„æ¼ Token çš„åŠ å¯†æ–¹å¼ã€‚å¦‚æœåŠ å¯†æ–¹å¼æ³„æ¼ï¼Œé‚£ä¹ˆç”¨æˆ·å°±å¯ä»¥åˆ©ç”¨å„ç§æ–¹æ³•é‡‡å–å®Œå…¨ç›¸åŒçš„åŠ å¯†æ–¹å¼åŠ å¯†å‡ºå®Œå…¨ç¬¦åˆæœåŠ¡ç«¯è§£å¯†å‡½æ•°éœ€æ±‚çš„ Tokenã€‚åœ¨è¿™é‡Œï¼ŒåŠ å¯†æ–¹å¼åŒ…å«çš„ä¸ä»…ä»…æ˜¯ method æœ¬èº«ï¼Œè¿˜æœ‰ keyã€‚")]),s._v(" "),a("h3",{attrs:{id:"token-åˆ©ç”¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-åˆ©ç”¨"}},[s._v("#")]),s._v(" Token åˆ©ç”¨")]),s._v(" "),a("p",[s._v("Token çš„åˆ©ç”¨ä¸»è¦ä½“ç°åœ¨è¯·æ±‚ä¸Šï¼Œä¸”æœ‰å¤šç§ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºæœ€ä¸ºç®€å•çš„ä¸€ç§ï¼šæ¯ä¸€æ¬¡ POST æ•æ„Ÿæ“ä½œæ¥å£ï¼Œé™„å¸¦ä¸Š Token ä½œä¸ºå‚æ•°ï¼Œåç«¯åœ¨æ¥åˆ°è¯·æ±‚åï¼Œç¬¬ä¸€æ­¥æ˜¯éªŒè¯ Tokenï¼Œé€šè¿‡åç»§ç»­æ“ä½œã€‚")]),s._v(" "),a("p",[s._v("æ¯”å¦‚ï¼Œæ¯æ¬¡ route è·³è½¬åˆ°æ•æ„Ÿé¡µé¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œè¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼š")]),s._v(" "),a("div",{staticClass:"language-typescript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkAuth")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" token "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxx-login-token"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Promise")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" j"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("j")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/CheckAuth.php"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("response "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("r")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("j")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("è¿™ä¸ªå‡½æ•°ä¼šè·å– localStorage ä¸­çš„ Token å¹¶å‘é€ç»™åç«¯ç›¸åº”çš„æ¥å£ï¼Œé€šè¿‡éªŒè¯ï¼Œè¿”å›ä¸€ä¸ªç»“æœå€¼ï¼Œå‰ç«¯å†æ ¹æ®è¿™ä¸ªç»“æœå€¼å†³å®šæ˜¯å¦è·³è½¬åˆ°æŒ‡å®šçš„é¡µé¢ã€‚")]),s._v(" "),a("p",[s._v("è‡³äº Token æ€æ ·éªŒè¯ï¼š")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("checkToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword type-hint"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$token")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æä¾›åŠ å¯†æ—¶çš„ key ä»¥è§£å¯†")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$content")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("json_decode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$token")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$content")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"expires"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("å…·ä½“åº”ç”¨ä¸­è¿˜å¯ä»¥æ·»åŠ æ›´å¤šéªŒè¯æ–¹å¼åœ¨é‡Œé¢ã€‚éªŒè¯æˆåŠŸï¼Œå°±ä¼šè¿”å›ä¸€ä¸ª trueã€‚å¦‚æœè¿‡æœŸï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿”å› falseã€‚å¦‚æœæ˜¯æ— æ•ˆçš„ Tokenï¼Œæ ¹æ®ä¸Šé¢çš„ encrypt å’Œ decrypt å‡½æ•°ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª Exceptionã€‚å¦‚æœäº§ç”Ÿè¿™ä¸ª Exceptionï¼Œå°±ä»£è¡¨é€šè¿‡éªŒè¯çš„ä¸€ä¸ªæˆ–å¤šä¸ªå¿…è¦æ¡ä»¶ä¸æ»¡è¶³ï¼Œè‡ªç„¶å°±èƒ½åˆ¤å®šè¿™ä¸ª Token æ— æ•ˆã€‚")]),s._v(" "),a("h3",{attrs:{id:"token-renew-expire-ç­–ç•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#token-renew-expire-ç­–ç•¥"}},[s._v("#")]),s._v(" Token renew & expire ç­–ç•¥")]),s._v(" "),a("p",[s._v("å¦‚æœ Token è¿‡æœŸäº†ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒå½“ä½œæ— æ•ˆ Token åŒç­‰å¤„ç†ï¼Œå³ "),a("code",[s._v("checkToken(x)")]),s._v(" å‡½æ•°æ°¸è¿œè¿”å› falseã€‚")]),s._v(" "),a("p",[s._v("è‡³äº Token çš„æ›´æ–°ä»¥åŠé”€æ¯ï¼Œå‰è€…ä¼šå‘ç”Ÿåœ¨ç™»å½•æ—¶ã€‚ç”±äº Token å·²ç»è¢«ï¼ˆè¿‘ä¹ï¼‰æ°¸è¿œå­˜åœ¨äº†å‰ç«¯ï¼Œæ‰€ä»¥è¿‡æœŸçš„ Token å¹¶æ²¡æœ‰å¿…è¦ç›´æ¥åˆ é™¤ã€‚æ¯æ¬¡ç™»å½•çš„æ—¶å€™ï¼Œå¦‚æœ Token æ²¡æœ‰è¿‡æœŸï¼Œé‚£ä¹ˆç›´æ¥è·³è½¬åˆ°ç›¸å…³é¡µé¢ï¼Œå¦‚æœ Token è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå°±è¿”å›ä¸€ä¸ªæ–°çš„ Tokenã€‚æ‰§è¡Œ localStorage çš„ setItem è¯­å¥ç›´æ¥è¦†ç›–æ—§ Token å³å¯ã€‚è€Œå¯¹äºé”€æ¯ï¼Œåˆ™æ˜¯ç”¨æˆ·ä¸“é—¨åœ¨ Token æœ‰æ•ˆçš„æ—¶å€™æ‰§è¡Œäº†ç›¸å…³çš„æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸éœ€è¦å’Œåç«¯æ²Ÿé€šï¼Œè€Œå‰ç«¯ç›´æ¥åˆ å» localStorage ä¸­ Token å¯¹åº”çš„æ•°æ®å³å¯ï¼Œç”±äºå‰é¢è·¯ç”±é€»è¾‘çš„å­˜åœ¨ï¼Œé¡µé¢åˆ·æ–°ä»¥åä¸€åˆ‡å°±è·Ÿæ²¡æœ‰ç™»å½•ä¸€æ ·äº†ã€‚")]),s._v(" "),a("h3",{attrs:{id:"æ›´å®‰å…¨çš„-encrypt-å’Œ-decrypt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ›´å®‰å…¨çš„-encrypt-å’Œ-decrypt"}},[s._v("#")]),s._v(" æ›´å®‰å…¨çš„ encrypt å’Œ decrypt")]),s._v(" "),a("p",[s._v("æ›´å®‰å…¨çš„ encrypt æ˜¯å°†åŸå…ˆä¸å®‰å…¨å‡½æ•°çš„åŠ å¯†ç»“æœçš„å¼€å¤´åŠ ä¸Šä¸€ä¸ªè®¡ç®—å‡ºçš„ MAC å€¼ã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("encrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$authKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("splitKeys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unsafe_encrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¡ç®—")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mac")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$authKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æŠŠ MAC æ”¾åœ¨å¼€å¤´")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mac")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("æ›´å®‰å…¨çš„è§£å¯†ä¹Ÿæ˜¯åŸºäº MAC çš„ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆéªŒè¯ MACï¼Œç„¶åå†ä½¿ç”¨å…ˆå‰çš„è§£å¯†å‡½æ•°å³å¯ã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$authKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("splitKeys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¿å…åŠ å¯†ç®—æ³•å˜æ¢")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mb_strlen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'8bit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mac")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mb_substr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'8bit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mb_substr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'8bit'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$calculated")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$authKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hashEquals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$mac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$calculated")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$plaintext")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unsafe_decrypt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ciphertext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$plaintext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("ä»¥ä¸Šæ“ä½œä¾èµ–äº†ä¸¤ä¸ªé¢å¤–çš„å‡½æ•°ã€‚ä¸€ä¸ªæ˜¯ç”¨æ¥æŠŠä¸€ä¸ª key åˆ†å‰²æˆä¸€ä¸ªç”¨æ¥åŠ å¯†ä¸€ä¸ªç”¨æ¥éªŒè¯çš„ä¸¤ä¸ª keyã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("splitKeys")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$masterKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'ENCRYPTION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$masterKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'AUTHENTICATION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$masterKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("å¦ä¸€ä¸ªæ˜¯ç”¨æ¥éªŒè¯ hash æ˜¯å¦å…¨ç­‰ã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("hashEquals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("function_exists")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'hash_equals'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_random_pseudo_bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_hmac")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'sha256'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$nonce")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("#")]),s._v(" æ€»ç»“")]),s._v(" "),a("p",[s._v("è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹æ¥è¯´ç‰¹åˆ«ç®€å•çš„ç™»å½•æˆ–è€…è¯´æ˜¯éªŒè¯ç³»ç»Ÿã€‚ä¸»è¦çš„ä»£ç éƒ½å†™åœ¨äº†åŠ å¯†å’Œè§£å¯†ä¸Šã€‚å¯¹äºè¿™æ ·ä¸€ä¸ªç³»ç»Ÿï¼Œæ˜¯è‚¯å®šå­˜åœ¨æ¼æ´çš„ï¼Œå› è€Œä¸èƒ½ç”¨æ¥å½“ä½œä¸€ä¸ªç‰¹åˆ«é‡è¦ç³»ç»Ÿçš„ä¸»è¦éªŒè¯æ–¹å¼ã€‚ä½†æ˜¯é€šè¿‡å®Œå–„ï¼Œè¿˜æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ªç³»ç»Ÿçš„æœ‰æ•ˆæ€§çš„ã€‚")]),s._v(" "),a("p",[s._v("è¿™ä¸ªç³»ç»Ÿåœ¨æµè§ˆå™¨æ— ç—•æ¨¡å¼ä¸‹æ˜¯æ— æ³•è®°å½• Token çš„ï¼Œè¿™ç‚¹å’Œæ­£å¸¸çš„ç™»å½•ä¹Ÿç±»ä¼¼ã€‚")]),s._v(" "),a("p",[s._v("è¿™ä¸ªç³»ç»Ÿä¸æ­¢ PHP èƒ½å®ç°ï¼Œè€Œèƒ½åœ¨æ‰€æœ‰çš„è¯­è¨€ä¸­å®ç°ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);